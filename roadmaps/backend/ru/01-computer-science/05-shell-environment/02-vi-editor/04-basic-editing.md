# Базовое редактирование в Vi (Basic Editing)

## Удаление текста

### Команда d (delete)

Основная команда удаления. Работает по формуле: `d + motion`

```bash
# Удаление символов
x       # удалить символ под курсором
X       # удалить символ перед курсором

# Удаление с движением
dw      # удалить слово (delete word)
de      # удалить до конца слова
db      # удалить слово назад
d$      # удалить до конца строки (или D)
d0      # удалить до начала строки
d^      # удалить до первого непробельного символа

# Удаление строк
dd      # удалить текущую строку
5dd     # удалить 5 строк
dj      # удалить текущую и следующую строку
dk      # удалить текущую и предыдущую строку

# Удаление до позиции
dG      # удалить до конца файла
dgg     # удалить до начала файла
d/word  # удалить до первого вхождения "word"
df)     # удалить до ')' включительно
dt)     # удалить до ')' не включая
d%      # удалить до парной скобки
```

### Удаление текстовых объектов

Vi понимает структуру текста:

```bash
# Внутри объекта (inner)
diw     # удалить слово (delete inner word)
dis     # удалить предложение (sentence)
dip     # удалить абзац (paragraph)
di"     # удалить внутри кавычек
di'     # удалить внутри апострофов
di(     # удалить внутри скобок (или dib)
di[     # удалить внутри квадратных скобок
di{     # удалить внутри фигурных скобок (или diB)
dit     # удалить внутри тега (HTML/XML)

# Включая объект (around)
daw     # удалить слово с пробелами вокруг
das     # удалить предложение с пробелом
dap     # удалить абзац с пустой строкой
da"     # удалить с кавычками
da(     # удалить со скобками
```

**Пример:**

```
Текст: function("hello world")
                     ^
Курсор внутри кавычек

di"  →  function("")
da"  →  function()
```

## Копирование (Yank)

В Vi копирование называется "yank" (выдернуть):

```bash
# Копирование с движением
yw      # копировать слово
y$      # копировать до конца строки
y0      # копировать до начала строки
y^      # копировать до первого непробельного символа

# Копирование строк
yy      # копировать текущую строку (или Y)
5yy     # копировать 5 строк
yj      # копировать текущую и следующую строку

# Копирование до позиции
yG      # копировать до конца файла
ygg     # копировать до начала файла

# Копирование объектов
yiw     # копировать слово
yi"     # копировать текст внутри кавычек
yi(     # копировать текст внутри скобок
yip     # копировать абзац
```

## Вставка (Put/Paste)

```bash
p       # вставить после курсора/строки
P       # вставить перед курсором/строкой
```

**Поведение зависит от того, что скопировано:**

```bash
# Если скопировано yy (целая строка):
p       # вставить строку ниже текущей
P       # вставить строку выше текущей

# Если скопировано yw (часть строки):
p       # вставить после курсора
P       # вставить перед курсором
```

**Вставка несколько раз:**

```bash
3p      # вставить 3 раза
```

## Изменение (Change)

Команда `c` удаляет текст и переходит в Insert mode:

```bash
# Изменение с движением
cw      # изменить слово (delete + insert)
ce      # изменить до конца слова
c$      # изменить до конца строки (или C)
c0      # изменить до начала строки
c^      # изменить до первого непробельного символа

# Изменение строки
cc      # изменить всю строку (или S)
5cc     # изменить 5 строк

# Изменение объектов
ciw     # изменить слово
ci"     # изменить внутри кавычек
ci(     # изменить внутри скобок
cit     # изменить внутри тега

# Изменение символа
s       # удалить символ и войти в Insert (substitute)
r{char} # заменить символ на {char} (остаться в Normal mode)
R       # режим замены (overwrite mode)
```

**Пример использования `ci"`:**

```
Текст: message = "Hello World"
                       ^
Курсор внутри кавычек

ci"  →  message = "|"
        (курсор между кавычками, Insert mode)

Ввести: Goodbye
Esc

Результат: message = "Goodbye"
```

## Отмена и повтор

```bash
u       # отменить последнее действие (undo)
U       # отменить все изменения в текущей строке
Ctrl+r  # повторить отменённое действие (redo)
.       # повторить последнюю команду редактирования
```

**Команда `.` — очень мощная:**

```bash
# Пример: удалить все строки с "debug"
/debug<Enter>   # найти первое вхождение
dd              # удалить строку
n               # следующее вхождение
.               # повторить dd
n.              # ещё раз: найти и удалить
n.n.n.          # продолжать
```

## Работа со строками

### Объединение строк

```bash
J       # объединить текущую строку со следующей
3J      # объединить 3 строки
gJ      # объединить без добавления пробела
```

### Смена регистра

```bash
~       # изменить регистр символа под курсором
g~w     # изменить регистр слова
g~~     # изменить регистр всей строки
gUw     # слово в верхний регистр
guw     # слово в нижний регистр
gUU     # вся строка в верхний регистр
guu     # вся строка в нижний регистр
```

### Отступы

```bash
>>      # добавить отступ текущей строке
<<      # убрать отступ
3>>     # добавить отступ 3 строкам

# В Visual mode
>       # добавить отступ выделенному
<       # убрать отступ

# Авто-отступ
==      # автоматический отступ текущей строки
=G      # авто-отступ до конца файла
gg=G    # авто-отступ всего файла
```

## Регистры (буферы обмена)

Vi имеет множество регистров для хранения текста:

```bash
# Использование именованных регистров
"ayy    # копировать строку в регистр 'a'
"ap     # вставить из регистра 'a'
"bdd    # удалить строку в регистр 'b'

# Просмотр регистров
:reg    # показать все регистры

# Специальные регистры
""      # безымянный регистр (последнее удаление/копирование)
"0      # последний yank
"1-"9   # история удалений
"+      # системный буфер обмена
"*      # selection буфер (X11)
"_      # чёрная дыра (удаление без сохранения)
```

**Пример работы с регистрами:**

```bash
"ayy    # копировать строку в 'a'
"byy    # копировать другую строку в 'b'
# ... перейти в другое место ...
"ap     # вставить из 'a'
"bp     # вставить из 'b'
```

## Практические примеры

### Пример 1: Переместить строку

```bash
dd      # удалить (вырезать) строку
# перейти на нужное место
p       # вставить
```

### Пример 2: Дублировать строку

```bash
yyp     # копировать и вставить ниже
yyP     # копировать и вставить выше
```

### Пример 3: Удалить слово и напечатать новое

```bash
cw      # удалить слово и войти в Insert
# напечатать новое слово
Esc     # выйти в Normal mode
```

### Пример 4: Заменить текст в кавычках

```bash
ci"     # удалить внутри кавычек и войти в Insert
# напечатать новый текст
Esc
```

### Пример 5: Скопировать функцию

```bash
# Курсор на открывающей { функции
V%y     # выделить до парной }, копировать
# или
yi{     # копировать внутри {}
```

### Пример 6: Удалить всё внутри скобок

```bash
di(     # удалить содержимое ()
di{     # удалить содержимое {}
di[     # удалить содержимое []
```

## Таблица команд

| Действие | Команда |
|----------|---------|
| Удалить символ | x |
| Удалить слово | dw |
| Удалить строку | dd |
| Удалить до конца строки | D или d$ |
| Копировать строку | yy |
| Копировать слово | yw |
| Вставить после | p |
| Вставить перед | P |
| Изменить слово | cw |
| Изменить строку | cc или S |
| Заменить символ | r{char} |
| Отменить | u |
| Повторить | Ctrl+r |
| Повторить команду | . |

## Резюме

- `d`, `c`, `y` работают по формуле: `команда + движение`
- `dd`, `cc`, `yy` — работа с целой строкой
- `i` (inner) и `a` (around) — текстовые объекты
- `p` и `P` — вставка после/перед
- `u` и `Ctrl+r` — отмена и повтор
- `.` — повторение последней команды
- Регистры позволяют хранить несколько фрагментов текста
