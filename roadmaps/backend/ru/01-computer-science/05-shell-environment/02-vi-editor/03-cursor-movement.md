# Перемещение курсора в Vi (Cursor Movement)

[prev: 02-editing-modes](./02-editing-modes.md) | [next: 04-basic-editing](./04-basic-editing.md)

---
## Базовое перемещение: h, j, k, l

Основные клавиши навигации в Normal mode:

```
     k
     ^
     |
h <--+--> l
     |
     v
     j
```

| Клавиша | Направление | Мнемоника |
|---------|-------------|-----------|
| h | влево | крайняя левая клавиша |
| j | вниз | "j" похожа на стрелку вниз (крючок внизу) |
| k | вверх | "k" похожа на стрелку вверх |
| l | вправо | крайняя правая клавиша |

**Почему hjkl, а не стрелки?**

1. Пальцы остаются на основном ряду клавиатуры
2. Быстрее, чем тянуться к стрелкам
3. Исторически: терминал ADM-3A (где создавался Vi) имел стрелки на этих клавишах

**Стрелки тоже работают**, но профессионалы используют hjkl.

## Перемещение с множителем

Перед любой командой движения можно указать число:

```bash
5j     # переместиться на 5 строк вниз
10l    # переместиться на 10 символов вправо
3k     # переместиться на 3 строки вверх
20h    # переместиться на 20 символов влево
```

## Перемещение по словам

Более эффективное перемещение, чем по символам:

```
w    — перейти к началу следующего слова (word)
W    — перейти к началу следующего СЛОВА (разделитель — пробел)
b    — перейти к началу предыдущего слова (back)
B    — перейти к началу предыдущего СЛОВА
e    — перейти к концу текущего/следующего слова (end)
E    — перейти к концу СЛОВА
```

**Разница между w и W:**

```
Текст: file.txt is ready
       ^
Курсор здесь

w  →  file.txt is ready
           ^
      (остановился на точке — это разделитель для w)

W  →  file.txt is ready
               ^
      (прошёл всё "слово" file.txt целиком)
```

**Слово (word)** — буквы, цифры, подчёркивания
**СЛОВО (WORD)** — любые символы до пробела

**Примеры с числами:**

```bash
3w    # перейти вперёд на 3 слова
2b    # перейти назад на 2 слова
```

## Перемещение внутри строки

```
0      — в начало строки (столбец 0)
^      — на первый непробельный символ строки
$      — в конец строки
g_     — на последний непробельный символ

|      — на указанный столбец (например, 20| на 20-й столбец)
```

**Визуализация:**

```
    Hello, World!
^   ^            ^
0   ^            $
    (первый      (конец)
    непробельный)
```

## Перемещение по строкам

```
gg     — на первую строку файла
G      — на последнюю строку файла
:n     — на строку номер n (например, :42)
nG     — на строку номер n (например, 42G)
```

**Примеры:**

```bash
gg     # в начало файла
G      # в конец файла
:100   # на строку 100
50G    # на строку 50
50%    # на 50% файла (середина)
```

## Перемещение по экрану

```
H      — на верх экрана (High)
M      — на середину экрана (Middle)
L      — на низ экрана (Low)
```

## Прокрутка экрана

```
Ctrl+f    — страница вперёд (forward)
Ctrl+b    — страница назад (backward)
Ctrl+d    — полстраницы вниз (down)
Ctrl+u    — полстраницы вверх (up)

Ctrl+e    — прокрутка вниз (строка)
Ctrl+y    — прокрутка вверх (строка)

zz        — центрировать экран на текущей строке
zt        — текущая строка вверху экрана (top)
zb        — текущая строка внизу экрана (bottom)
```

## Перемещение по предложениям и абзацам

```
(      — на начало предыдущего предложения
)      — на начало следующего предложения
{      — на начало предыдущего абзаца
}      — на начало следующего абзаца
```

**Предложение** — текст, заканчивающийся на `.`, `!`, или `?` с пробелом после.
**Абзац** — блок текста, отделённый пустыми строками.

## Поиск символа в строке

Очень мощные команды для быстрой навигации внутри строки:

```
f{char}    — найти символ вперёд (find)
F{char}    — найти символ назад
t{char}    — переместиться до символа (till)
T{char}    — переместиться до символа назад

;          — повторить f/F/t/T в том же направлении
,          — повторить f/F/t/T в обратном направлении
```

**Примеры:**

```
Текст: function calculate(x, y) {
       ^
Курсор в начале

fa  →  function calculate(x, y) {
                ^
       (первая 'a')

;   →  function calculate(x, y) {
                   ^
       (следующая 'a')

f(  →  function calculate(x, y) {
                         ^
       (открывающая скобка)

t)  →  function calculate(x, y) {
                              ^
       (символ ДО закрывающей скобки)
```

## Поиск по файлу

```
/pattern    — искать вперёд
?pattern    — искать назад
n           — следующее совпадение
N           — предыдущее совпадение
*           — искать слово под курсором вперёд
#           — искать слово под курсором назад
```

**Примеры:**

```bash
/function    # искать "function" вперёд
n            # следующее "function"
N            # предыдущее "function"

# Курсор на слове "error"
*            # найти следующее "error"
```

## Перемещение по парным скобкам

```
%    — перейти к парной скобке (), [], {}
```

**Пример:**

```
function test(arg) {
              ^
Курсор на '('

%  →  function test(arg) {
                       ^
       (перешёл на парную ')')

%  →  function test(arg) {
              ^
       (вернулся на '(')
```

## Метки (Marks)

Можно отмечать позиции и возвращаться к ним:

```
m{a-z}    — установить метку (например, ma)
'{a-z}    — перейти к строке с меткой
`{a-z}    — перейти точно к позиции метки
```

**Пример:**

```bash
ma        # установить метку 'a' в текущей позиции
# ... редактирование в другом месте ...
'a        # вернуться к строке с меткой 'a'
`a        # вернуться точно к позиции метки 'a'
```

**Специальные метки:**

```
''    — вернуться к позиции до последнего прыжка
'.    — позиция последнего изменения
'^    — позиция последней вставки
```

## Команды перемещения с редактированием

Команды перемещения комбинируются с командами редактирования:

```
d{motion}    — удалить до позиции
c{motion}    — изменить до позиции (удалить и войти в Insert)
y{motion}    — копировать до позиции
```

**Примеры:**

```bash
dw      # удалить слово (delete word)
d$      # удалить до конца строки
d0      # удалить до начала строки
dG      # удалить до конца файла
dgg     # удалить до начала файла
df)     # удалить до ')' включительно
dt)     # удалить до ')' не включая

cw      # изменить слово
c$      # изменить до конца строки (или C)
ci"     # изменить внутри кавычек (change inside ")

yw      # копировать слово
y$      # копировать до конца строки
yy      # копировать всю строку
```

## Практические комбинации

```bash
# Перейти к функции main и центрировать экран
/main<Enter>zz

# Удалить от курсора до слова "error"
d/error<Enter>

# Копировать абзац
y}

# Удалить до парной скобки
d%

# Перейти на строку 100 и удалить 5 строк
100G5dd
```

## Резюме

| Тип движения | Команды |
|--------------|---------|
| Посимвольно | h, j, k, l |
| По словам | w, b, e, W, B, E |
| В строке | 0, ^, $, f, t |
| По файлу | gg, G, :n, /pattern |
| По экрану | H, M, L, Ctrl+f/b/d/u |
| По структуре | (, ), {, }, % |

- Используйте hjkl вместо стрелок для эффективности
- Перемещение по словам (w, b) быстрее, чем по символам
- Комбинируйте числа с движениями: 5j, 3w
- f и t — мощные команды для навигации в строке
- Команды движения работают с d, c, y для редактирования

---

[prev: 02-editing-modes](./02-editing-modes.md) | [next: 04-basic-editing](./04-basic-editing.md)
