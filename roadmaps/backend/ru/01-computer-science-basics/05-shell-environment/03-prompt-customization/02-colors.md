# Цвета в командной строке (Colors)

## ANSI Escape-коды

Терминалы поддерживают цветной вывод через **ANSI escape-коды**. Это специальные последовательности символов, которые терминал интерпретирует как команды форматирования.

### Базовый синтаксис

```bash
\e[CODEm     # или \033[CODEm, или \x1b[CODEm

# Примеры:
\e[31m       # красный цвет текста
\e[0m        # сброс форматирования
```

**Варианты записи escape-символа:**
- `\e` — в bash (рекомендуется)
- `\033` — восьмеричное представление
- `\x1b` — шестнадцатеричное представление

## Цвета текста (Foreground)

### Стандартные цвета (30-37)

| Код | Цвет |
|-----|------|
| 30 | Чёрный |
| 31 | Красный |
| 32 | Зелёный |
| 33 | Жёлтый |
| 34 | Синий |
| 35 | Пурпурный (Magenta) |
| 36 | Голубой (Cyan) |
| 37 | Белый |

```bash
echo -e "\e[31mКрасный текст\e[0m"
echo -e "\e[32mЗелёный текст\e[0m"
echo -e "\e[33mЖёлтый текст\e[0m"
```

### Яркие цвета (90-97)

| Код | Цвет |
|-----|------|
| 90 | Серый (Bright Black) |
| 91 | Ярко-красный |
| 92 | Ярко-зелёный |
| 93 | Ярко-жёлтый |
| 94 | Ярко-синий |
| 95 | Ярко-пурпурный |
| 96 | Ярко-голубой |
| 97 | Ярко-белый |

```bash
echo -e "\e[91mЯрко-красный\e[0m"
echo -e "\e[92mЯрко-зелёный\e[0m"
```

## Цвета фона (Background)

### Стандартные цвета (40-47)

| Код | Цвет фона |
|-----|-----------|
| 40 | Чёрный |
| 41 | Красный |
| 42 | Зелёный |
| 43 | Жёлтый |
| 44 | Синий |
| 45 | Пурпурный |
| 46 | Голубой |
| 47 | Белый |

### Яркие цвета фона (100-107)

| Код | Цвет фона |
|-----|-----------|
| 100 | Серый |
| 101 | Ярко-красный |
| 102 | Ярко-зелёный |
| ... | ... |

```bash
echo -e "\e[41mКрасный фон\e[0m"
echo -e "\e[44mСиний фон\e[0m"
echo -e "\e[30;43mЧёрный текст на жёлтом фоне\e[0m"
```

## Стили текста

| Код | Стиль |
|-----|-------|
| 0 | Сброс всего форматирования |
| 1 | Жирный / Яркий |
| 2 | Тусклый |
| 3 | Курсив |
| 4 | Подчёркнутый |
| 5 | Мигающий |
| 7 | Инвертированный (негатив) |
| 8 | Скрытый |
| 9 | Зачёркнутый |

```bash
echo -e "\e[1mЖирный текст\e[0m"
echo -e "\e[4mПодчёркнутый текст\e[0m"
echo -e "\e[1;4mЖирный и подчёркнутый\e[0m"
echo -e "\e[7mИнвертированный\e[0m"
```

## Комбинирование кодов

Коды можно комбинировать через `;`:

```bash
# Жирный красный текст
echo -e "\e[1;31mЖирный красный\e[0m"

# Зелёный текст на чёрном фоне
echo -e "\e[32;40mЗелёный на чёрном\e[0m"

# Жирный, подчёркнутый, синий
echo -e "\e[1;4;34mЖирный подчёркнутый синий\e[0m"
```

## Цвета в PS1

**Важно:** В PS1 escape-коды должны быть обёрнуты в `\[` и `\]`, иначе bash неправильно рассчитает длину строки:

```bash
# НЕПРАВИЛЬНО (проблемы с переносом строк):
PS1="\e[32m\u@\h\e[0m:\e[34m\w\e[0m\$ "

# ПРАВИЛЬНО:
PS1="\[\e[32m\]\u@\h\[\e[0m\]:\[\e[34m\]\w\[\e[0m\]\$ "
```

### Примеры цветных промптов

```bash
# Зелёное имя пользователя, синяя директория
PS1='\[\e[32m\]\u@\h\[\e[0m\]:\[\e[34m\]\w\[\e[0m\]\$ '

# Красный для root, зелёный для обычного пользователя
if [ $UID -eq 0 ]; then
    PS1='\[\e[31m\]\u@\h:\w\$\[\e[0m\] '
else
    PS1='\[\e[32m\]\u@\h:\w\$\[\e[0m\] '
fi

# Жёлтое время, белый текст
PS1='\[\e[33m\][\t]\[\e[0m\] \u@\h:\w\$ '
```

## 256 цветов

Современные терминалы поддерживают 256 цветов:

```bash
# Цвет текста (38;5;N)
echo -e "\e[38;5;208mОранжевый (цвет 208)\e[0m"

# Цвет фона (48;5;N)
echo -e "\e[48;5;27mФон цвета 27\e[0m"
```

### Просмотр всех 256 цветов

```bash
for i in {0..255}; do
    printf "\e[38;5;${i}m%3d\e[0m " "$i"
    if (( (i + 1) % 16 == 0 )); then
        echo
    fi
done
```

## True Color (24-bit)

Некоторые терминалы поддерживают 16 миллионов цветов:

```bash
# RGB цвет текста (38;2;R;G;B)
echo -e "\e[38;2;255;100;0mОранжевый RGB\e[0m"

# RGB цвет фона (48;2;R;G;B)
echo -e "\e[48;2;0;100;255mСиний фон RGB\e[0m"
```

## Переменные для удобства

Создайте переменные для часто используемых цветов:

```bash
# Определение цветов
RED='\[\e[31m\]'
GREEN='\[\e[32m\]'
YELLOW='\[\e[33m\]'
BLUE='\[\e[34m\]'
PURPLE='\[\e[35m\]'
CYAN='\[\e[36m\]'
WHITE='\[\e[37m\]'
RESET='\[\e[0m\]'
BOLD='\[\e[1m\]'

# Использование в PS1
PS1="${GREEN}\u@\h${RESET}:${BLUE}\w${RESET}\$ "
```

## Цвета в командах

Многие команды поддерживают цветной вывод:

```bash
# ls с цветами
ls --color=auto

# grep с цветами
grep --color=auto pattern file

# Установить по умолчанию в .bashrc
alias ls='ls --color=auto'
alias grep='grep --color=auto'
```

### Переменная LS_COLORS

Настраивает цвета для `ls`:

```bash
# Посмотреть текущие настройки
echo $LS_COLORS

# Формат: type=attributes:type=attributes:...
# di=директории, fi=файлы, ln=ссылки, ex=исполняемые

# Пример настройки
export LS_COLORS="di=1;34:ln=1;36:ex=1;32"
```

## Практические примеры промптов

### Минималистичный с цветом

```bash
PS1='\[\e[32m\]\$\[\e[0m\] '
# Зелёный $
```

### Информативный

```bash
PS1='\[\e[1;33m\][\t]\[\e[0m\] \[\e[1;32m\]\u\[\e[0m\]@\[\e[1;34m\]\h\[\e[0m\]:\[\e[1;35m\]\w\[\e[0m\]\n\$ '
# [14:30:45] username@hostname:~/projects
# $
```

### С индикатором успеха/ошибки

```bash
prompt_command() {
    if [ $? -eq 0 ]; then
        PS1='\[\e[32m\]✓\[\e[0m\] \w\$ '
    else
        PS1='\[\e[31m\]✗\[\e[0m\] \w\$ '
    fi
}
PROMPT_COMMAND=prompt_command
```

### Git-aware с цветами

```bash
parse_git_branch() {
    git branch 2>/dev/null | sed -n 's/* \(.*\)/(\1)/p'
}

PS1='\[\e[32m\]\u@\h\[\e[0m\]:\[\e[34m\]\w\[\e[0m\] \[\e[33m\]$(parse_git_branch)\[\e[0m\]\$ '
# username@hostname:~/projects (main)$
```

## Проверка поддержки цветов

```bash
# Проверить количество цветов
tput colors
# 256 или 8

# Проверить переменную TERM
echo $TERM
# xterm-256color
```

## Резюме

| Код | Значение |
|-----|----------|
| 30-37 | Цвет текста |
| 40-47 | Цвет фона |
| 90-97 | Яркий цвет текста |
| 100-107 | Яркий цвет фона |
| 0 | Сброс |
| 1 | Жирный |
| 4 | Подчёркнутый |

Основные правила:
- `\e[CODEm` — установить форматирование
- `\e[0m` — сбросить форматирование
- В PS1 обязательно оборачивать в `\[` и `\]`
- Коды комбинируются через `;`
- 256 цветов: `\e[38;5;Nm` и `\e[48;5;Nm`
