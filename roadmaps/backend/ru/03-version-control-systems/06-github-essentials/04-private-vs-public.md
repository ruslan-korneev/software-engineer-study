# Приватные vs Публичные репозитории

[prev: 03-creating-repositories](./03-creating-repositories.md) | [next: 05-profile-setup](./05-profile-setup.md)
---

## Введение

При создании репозитория на GitHub вы выбираете его видимость: публичный (public) или приватный (private). Этот выбор влияет на доступность кода, возможности совместной работы и доступные функции. В этом разделе разберём различия и поможем выбрать правильный вариант.

---

## 1. Основные отличия

### Публичный репозиторий (Public)

```
┌─────────────────────────────────────────────────────────────────┐
│ 🌍 PUBLIC REPOSITORY                                            │
├─────────────────────────────────────────────────────────────────┤
│ Видимость:     Виден всем в интернете                           │
│ Код:           Доступен для просмотра и клонирования всем       │
│ Поиск:         Индексируется поисковиками                       │
│ Участники:     Любой может создать fork и PR                    │
│ Стоимость:     Полностью бесплатно                              │
└─────────────────────────────────────────────────────────────────┘
```

### Приватный репозиторий (Private)

```
┌─────────────────────────────────────────────────────────────────┐
│ 🔒 PRIVATE REPOSITORY                                           │
├─────────────────────────────────────────────────────────────────┤
│ Видимость:     Виден только владельцу и приглашённым            │
│ Код:           Доступен только авторизованным пользователям     │
│ Поиск:         Не индексируется                                 │
│ Участники:     Только приглашённые collaborators                │
│ Стоимость:     Бесплатно с ограничениями / Pro для команд       │
└─────────────────────────────────────────────────────────────────┘
```

### Сравнительная таблица

| Характеристика | Public | Private |
|----------------|--------|---------|
| Видимость | Все | Только приглашённые |
| Клонирование | Все могут | Только с доступом |
| Fork | Разрешён всем | Только collaborators |
| GitHub Pages | Бесплатно | Требует Pro (или Free с ограничениями) |
| Issues/PR | От всех | Только от collaborators |
| Actions | 2000+ мин/месяц | 2000 мин/месяц (Free) |
| Packages | Бесплатно | С лимитами |
| Environments | Все | Все |
| Code scanning | Бесплатно | Требует GHAS |

---

## 2. Когда использовать Public

### Идеальные сценарии

**1. Open Source проекты**
```
Преимущества:
- Сообщество может контрибутить
- Виден в поиске — привлекает пользователей
- Бесплатные GitHub Actions минуты
- Бесплатное сканирование безопасности
```

**2. Портфолио и демонстрация навыков**
```
Для разработчиков:
- Рекрутёры могут оценить код
- Показывает активность и стиль
- Демонстрирует конкретные технологии
```

**3. Учебные проекты**
```
Для обучения:
- Другие могут учиться на вашем коде
- Получаете обратную связь
- Строите публичную историю
```

**4. Библиотеки и пакеты**
```
Для распространения:
- Пользователи видят исходный код
- Могут создавать issues
- Легко устанавливать через npm, pip и т.д.
```

**5. Документация и ресурсы**
```
Для сообщества:
- Туториалы и guides
- Awesome-списки
- Шаблоны и boilerplates
```

### Что НЕ публиковать в public

```
⚠️ НИКОГДА не публикуйте:
- Пароли и секреты
- API ключи
- Приватные SSH ключи
- Конфиденциальные данные клиентов
- Проприетарный код работодателя
- Персональные данные (GDPR!)
```

---

## 3. Когда использовать Private

### Идеальные сценарии

**1. Коммерческие/корпоративные проекты**
```
Преимущества:
- Защита интеллектуальной собственности
- Конкуренты не видят код
- Контроль доступа
```

**2. Проекты в разработке**
```
Пока код не готов:
- Можно работать без внешнего внимания
- Нет pressure от пользователей
- Позже можно сделать public
```

**3. Клиентские проекты**
```
Для фрилансеров/агентств:
- Код принадлежит клиенту
- NDA требует конфиденциальности
- Контролируемый доступ для клиента
```

**4. Личные конфигурации**
```
Приватная информация:
- Dotfiles с токенами
- Личные скрипты
- Бэкапы
```

**5. Эксперименты**
```
Пробные проекты:
- Не хочется показывать "грязный" код
- Обучение новым технологиям
- Прототипы
```

---

## 4. Ограничения в бесплатном плане

### GitHub Free (Personal)

```
Public repos:
✓ Неограниченное количество
✓ Неограниченные collaborators
✓ GitHub Actions: 2000 мин/месяц (Linux)
✓ GitHub Packages: 500 MB storage
✓ Community support

Private repos:
✓ Неограниченное количество
✓ До 3 collaborators (для личного аккаунта)
✓ GitHub Actions: 2000 мин/месяц
✓ GitHub Packages: 500 MB
✗ Protected branches (ограничено)
✗ Multiple reviewers required
✗ Code owners
```

### GitHub Pro ($4/месяц)

```
Всё из Free, плюс:
✓ Неограниченные collaborators для private
✓ Protected branches с расширенными правилами
✓ Required reviewers
✓ Code owners
✓ GitHub Pages для private repos
✓ Wikis для private repos
✓ Insights (traffic, clones)
✓ 3000 Actions минут
```

### GitHub Team ($4/user/месяц)

```
Для организаций:
✓ Неограниченные private repos
✓ Team discussions
✓ Draft PRs
✓ Multiple reviewers
✓ Code owners
✓ Required status checks
✓ 3000 Actions минут
```

### GitHub Enterprise

```
Корпоративные функции:
✓ SAML SSO
✓ Audit logs
✓ GitHub Connect
✓ Advanced security (GHAS)
✓ 50000 Actions минут
✓ Premium support
```

---

## 5. Смена видимости репозитория

### Из Private в Public

```
Settings → General → Danger Zone → Change repository visibility

⚠️ Предупреждение:
- Вся история коммитов станет публичной
- Включая удалённые файлы (они в истории!)
- Поисковики начнут индексировать
- Forks станут возможны
```

**Перед публикацией проверьте:**
```bash
# Поиск секретов в истории
git log -p | grep -i "password\|secret\|api_key\|token"

# Или используйте инструменты:
# - git-secrets
# - truffleHog
# - gitleaks
```

### Из Public в Private

```
Settings → General → Danger Zone → Change repository visibility

Последствия:
- Существующие forks останутся публичными!
- GitHub Pages перестанет работать (без Pro)
- Collaborators сохранят доступ
- Stars и Watchers сохранятся
```

### Важно о Forks

```
┌─────────────────────────────────────────────────────────────────┐
│ ⚠️ КРИТИЧЕСКИ ВАЖНО                                             │
├─────────────────────────────────────────────────────────────────┤
│ Если репозиторий был public и его форкнули:                     │
│                                                                 │
│ 1. Forks ОСТАНУТСЯ публичными после приватизации оригинала     │
│ 2. Код в форках будет доступен                                  │
│ 3. Вы НЕ МОЖЕТЕ удалить чужие forks                            │
│                                                                 │
│ Вывод: если в public попали секреты — смена на private         │
│ НЕ РЕШИТ проблему. Нужно ротировать все ключи!                 │
└─────────────────────────────────────────────────────────────────┘
```

---

## 6. Управление доступом к Private репозиториям

### Collaborators (Участники)

```
Settings → Collaborators and teams → Add people

Уровни доступа:
- Read      → только просмотр
- Triage    → управление issues (без кода)
- Write     → push в репозиторий
- Maintain  → управление репозиторием (без опасных действий)
- Admin     → полный контроль
```

### Приглашение collaborator

```
1. Settings → Collaborators
2. Add people
3. Ввести username или email
4. Выбрать роль
5. Send invitation

Приглашённый получит email и должен принять приглашение.
```

### Организации и Teams

Для более сложного управления:
```
Organization → Teams → Create team

Team permissions:
- Read
- Triage
- Write
- Maintain
- Admin

Можно настраивать доступ к группам репозиториев.
```

---

## 7. Internal репозитории (Enterprise)

### Что это

```
┌─────────────────────────────────────────────────────────────────┐
│ 🏢 INTERNAL REPOSITORY (только Enterprise)                      │
├─────────────────────────────────────────────────────────────────┤
│ Видимость: Все члены организации Enterprise                     │
│ Fork:      Внутри организации                                   │
│ Поиск:     Только внутри Enterprise                             │
│ Доступ:    Автоматический для членов Enterprise                 │
└─────────────────────────────────────────────────────────────────┘
```

### Когда использовать Internal

```
Примеры:
- Внутренние библиотеки компании
- Shared инструменты
- Документация для всех команд
- Inner source проекты
```

---

## 8. Best Practices

### Для Public репозиториев

```
1. Добавьте LICENSE
   - Без лицензии по умолчанию "все права защищены"
   - Выберите подходящую (MIT, Apache, GPL)

2. Создайте CONTRIBUTING.md
   - Как контрибутить
   - Код стиль
   - Процесс PR

3. Добавьте CODE_OF_CONDUCT.md
   - Правила сообщества
   - Контакты для жалоб

4. Настройте Issue/PR templates
   - Стандартизация отчётов
   - Ускорение обработки

5. Включите Discussions (если нужно)
   - Для вопросов и идей
   - Разгружает Issues

6. Защитите ветки
   - Require reviews
   - Status checks
   - Signed commits
```

### Для Private репозиториев

```
1. Минимизируйте collaborators
   - Принцип least privilege
   - Регулярный audit доступа

2. Используйте branch protection
   - Даже если работаете один
   - Предотвращает случайный push в main

3. Не храните секреты в коде
   - Используйте GitHub Secrets
   - Или внешние хранилища (Vault)

4. Настройте CODEOWNERS
   - Автоматические reviewers
   - Контроль изменений критичных файлов

5. Включите security alerts
   - Dependabot
   - Code scanning (если доступно)
```

### Гибридный подход

```
Некоторые компании используют:

Private:
- Core бизнес-логика
- Инфраструктурный код
- Клиентские проекты

Public:
- SDK и клиентские библиотеки
- Документация
- Вспомогательные инструменты
- Примеры интеграции
```

---

## 9. Типичные ошибки

### Ошибка 1: Публикация секретов

```
❌ Плохо:
# config.py
API_KEY = "sk-1234567890abcdef"
DATABASE_URL = "postgres://user:password@host/db"

✅ Хорошо:
# config.py
import os
API_KEY = os.environ.get("API_KEY")
DATABASE_URL = os.environ.get("DATABASE_URL")

# .env (в .gitignore!)
API_KEY=sk-1234567890abcdef
DATABASE_URL=postgres://user:password@host/db
```

### Ошибка 2: Публикация проприетарного кода

```
❌ Плохо:
Выложить код работодателя в personal public repo

✅ Хорошо:
- Проверить контракт/NDA
- Получить разрешение
- Или создать аналог с нуля для портфолио
```

### Ошибка 3: Приватизация после утечки

```
❌ Плохо:
1. Опубликовать случайно секреты
2. Сделать repo private
3. Считать проблему решённой

✅ Хорошо:
1. Немедленно ротировать все скомпрометированные ключи
2. Очистить историю Git (git filter-branch или BFG)
3. Force push
4. Уведомить affected parties
```

### Ошибка 4: Слишком широкий доступ

```
❌ Плохо:
Дать Admin всем collaborators "на всякий случай"

✅ Хорошо:
- Read для стейкхолдеров
- Write для разработчиков
- Maintain для тимлидов
- Admin только владельцам
```

---

## 10. Проверка видимости

### Как узнать видимость репозитория

```
На странице репозитория:

🌍 Public    — виден значок "Public" под названием
🔒 Private   — виден значок "Private"
🏢 Internal  — виден значок "Internal" (Enterprise)
```

### Проверка через API/CLI

```bash
# GitHub CLI
gh repo view owner/repo --json visibility

# Результат:
{
  "visibility": "public"  # или "private"
}

# Список ваших репозиториев по видимости
gh repo list --visibility public
gh repo list --visibility private
```

---

## Заключение

Выбор между public и private зависит от:

| Фактор | Выбор |
|--------|-------|
| Open source проект | Public |
| Коммерческий код | Private |
| Портфолио | Public |
| Клиентский проект | Private |
| Библиотека для сообщества | Public |
| Внутренний инструмент | Private или Internal |

Помните:
- Public код виден всем, включая поисковики
- Private не значит "100% безопасно" — всё равно нужны хорошие практики
- Смена видимости — не способ решить проблему утёкших секретов
- Регулярно проверяйте, кто имеет доступ к private репозиториям

---
[prev: 03-creating-repositories](./03-creating-repositories.md) | [next: 05-profile-setup](./05-profile-setup.md)