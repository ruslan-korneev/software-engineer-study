# Что такое блокчейн

## Определение

**Блокчейн** (англ. blockchain — «цепочка блоков») — это распределённая база данных, в которой информация хранится в виде последовательно связанных блоков. Каждый блок содержит набор транзакций и криптографическую ссылку на предыдущий блок, что делает изменение ранее записанных данных практически невозможным.

Простыми словами: блокчейн — это цифровой журнал записей, который:
- Хранится одновременно на множестве компьютеров
- Не имеет единого центра управления
- Защищён криптографией от подделки

---

## История создания

### Предпосылки (1991-2008)

- **1991** — Стюарт Хабер и У. Скотт Сторнетта описали криптографически защищённую цепочку блоков
- **1992** — Добавлены деревья Меркла для более эффективного хранения документов
- **2004** — Хэл Финни создал систему Reusable Proof of Work (RPoW)

### Рождение Bitcoin (2008-2009)

- **31 октября 2008** — Сатоши Накамото (псевдоним) опубликовал whitepaper «Bitcoin: A Peer-to-Peer Electronic Cash System»
- **3 января 2009** — Создан генезис-блок (первый блок) сети Bitcoin
- **12 января 2009** — Первая транзакция: Сатоши отправил 10 BTC Хэлу Финни

### Развитие технологии (2013-настоящее время)

- **2013** — Виталик Бутерин предложил Ethereum со смарт-контрактами
- **2015** — Запуск Ethereum, открывший эру программируемых блокчейнов
- **2017** — Бум ICO (Initial Coin Offering)
- **2020-2021** — Взрывной рост DeFi и NFT
- **2022** — Переход Ethereum на Proof of Stake (The Merge)

---

## Основные принципы работы

### Высокоуровневая архитектура

```
┌─────────────────────────────────────────────────────────────────┐
│                         СЕТЬ БЛОКЧЕЙН                          │
├─────────────────────────────────────────────────────────────────┤
│                                                                 │
│   ┌─────────┐    ┌─────────┐    ┌─────────┐    ┌─────────┐    │
│   │ Блок 0  │───▶│ Блок 1  │───▶│ Блок 2  │───▶│ Блок 3  │    │
│   │(генезис)│    │         │    │         │    │         │    │
│   └─────────┘    └─────────┘    └─────────┘    └─────────┘    │
│                                                                 │
│   Каждый блок содержит:                                        │
│   • Хеш предыдущего блока                                      │
│   • Временную метку                                            │
│   • Данные транзакций                                          │
│   • Собственный хеш                                            │
│                                                                 │
└─────────────────────────────────────────────────────────────────┘
```

### Процесс добавления данных

1. **Инициация транзакции** — пользователь создаёт транзакцию
2. **Распространение** — транзакция рассылается по сети
3. **Валидация** — узлы проверяют корректность транзакции
4. **Формирование блока** — майнер/валидатор собирает транзакции в блок
5. **Консенсус** — сеть достигает согласия о новом блоке
6. **Добавление в цепочку** — блок становится частью блокчейна

### Демонстрация хеширования на Python

```python
import hashlib
import json
from datetime import datetime


def calculate_hash(data: str) -> str:
    """Вычисление SHA-256 хеша."""
    return hashlib.sha256(data.encode()).hexdigest()


class Block:
    """Простейшая реализация блока."""

    def __init__(self, index: int, transactions: list, previous_hash: str):
        self.index = index
        self.timestamp = datetime.now().isoformat()
        self.transactions = transactions
        self.previous_hash = previous_hash
        self.hash = self.calculate_block_hash()

    def calculate_block_hash(self) -> str:
        """Вычисление хеша блока."""
        block_data = json.dumps({
            "index": self.index,
            "timestamp": self.timestamp,
            "transactions": self.transactions,
            "previous_hash": self.previous_hash
        }, sort_keys=True)
        return calculate_hash(block_data)

    def __repr__(self):
        return f"Block(index={self.index}, hash={self.hash[:16]}...)"


# Демонстрация создания цепочки блоков
genesis_block = Block(0, ["Генезис транзакция"], "0" * 64)
print(f"Генезис блок: {genesis_block}")
print(f"Хеш: {genesis_block.hash}")

block_1 = Block(1, ["Алиса -> Боб: 10 BTC"], genesis_block.hash)
print(f"\nБлок 1: {block_1}")
print(f"Хеш предыдущего: {block_1.previous_hash[:16]}...")
print(f"Собственный хеш: {block_1.hash[:16]}...")
```

Вывод:
```
Генезис блок: Block(index=0, hash=a1b2c3d4e5f6...)
Хеш: a1b2c3d4e5f6...

Блок 1: Block(index=1, hash=f6e5d4c3b2a1...)
Хеш предыдущего: 0000000000000000...
Собственный хеш: f6e5d4c3b2a1...
```

---

## Ключевые свойства блокчейна

### 1. Неизменяемость (Immutability)

Данные в блокчейне практически невозможно изменить после записи:

```python
# Демонстрация: изменение данных ломает цепочку хешей
original_data = "Транзакция: Алиса -> Боб: 10 BTC"
original_hash = calculate_hash(original_data)

modified_data = "Транзакция: Алиса -> Боб: 100 BTC"  # Попытка подделки
modified_hash = calculate_hash(modified_data)

print(f"Оригинальный хеш: {original_hash[:32]}...")
print(f"Изменённый хеш:   {modified_hash[:32]}...")
print(f"Хеши совпадают: {original_hash == modified_hash}")  # False
```

Для подделки одной транзакции нужно пересчитать все последующие блоки, что требует огромных вычислительных ресурсов.

### 2. Прозрачность (Transparency)

- Все транзакции публично доступны для просмотра
- Любой участник может проверить историю операций
- Адреса псевдонимны, но не анонимны

### 3. Распределённость (Decentralization)

- Нет единой точки отказа
- Данные хранятся на тысячах узлов
- Сеть продолжает работать даже при отключении части узлов

### 4. Безопасность (Security)

- Криптографическая защита транзакций
- Консенсус предотвращает мошенничество
- Атака 51% требует контроля большинства сети

### 5. Необратимость (Finality)

- Подтверждённые транзакции нельзя отменить
- Чем больше подтверждений, тем надёжнее транзакция

---

## Типы блокчейнов

### Публичные (Public)

| Характеристика | Описание |
|----------------|----------|
| Доступ | Открытый для всех |
| Участие | Любой может стать узлом |
| Консенсус | PoW, PoS и др. |
| Примеры | Bitcoin, Ethereum, Solana |

**Преимущества:**
- Максимальная децентрализация
- Устойчивость к цензуре
- Полная прозрачность

**Недостатки:**
- Низкая скорость транзакций
- Высокое энергопотребление (для PoW)
- Сложность масштабирования

### Приватные (Private)

| Характеристика | Описание |
|----------------|----------|
| Доступ | Ограниченный |
| Участие | Только по приглашению |
| Консенсус | Упрощённые механизмы |
| Примеры | Hyperledger Fabric, R3 Corda |

**Преимущества:**
- Высокая скорость
- Контроль над участниками
- Конфиденциальность данных

**Недостатки:**
- Централизация
- Требует доверия к оператору

### Консорциумные (Consortium / Federated)

| Характеристика | Описание |
|----------------|----------|
| Доступ | Ограниченный группой организаций |
| Участие | Предопределённые участники |
| Консенсус | Голосование консорциума |
| Примеры | Quorum, Hyperledger Besu |

**Преимущества:**
- Баланс между децентрализацией и контролем
- Подходит для бизнес-применений
- Более высокая пропускная способность

---

## Простая аналогия для понимания

### Блокчейн как публичная бухгалтерская книга

Представьте деревню, где все сделки записываются в общую книгу:

```
┌─────────────────────────────────────────────────────────────────┐
│                    ДЕРЕВЕНСКАЯ КНИГА УЧЁТА                      │
├─────────────────────────────────────────────────────────────────┤
│                                                                 │
│  Страница 1 (Генезис):                                         │
│  ─────────────────────                                          │
│  Книга создана старейшиной                                     │
│  Подпись: [Печать деревни]                                     │
│                                                                 │
│  Страница 2:                                                   │
│  ───────────                                                    │
│  Ссылка на страницу 1: ✓                                       │
│  Иван продал корову Петру за 50 монет                          │
│  Свидетели: [10 жителей поставили подписи]                     │
│                                                                 │
│  Страница 3:                                                   │
│  ───────────                                                    │
│  Ссылка на страницу 2: ✓                                       │
│  Пётр продал молоко Марии за 5 монет                           │
│  Свидетели: [10 жителей поставили подписи]                     │
│                                                                 │
└─────────────────────────────────────────────────────────────────┘
```

**Аналогии:**
- **Страница** = Блок
- **Записи на странице** = Транзакции
- **Ссылка на предыдущую страницу** = Хеш предыдущего блока
- **Подписи свидетелей** = Консенсус сети
- **Копии книги у каждого жителя** = Распределённость

**Почему нельзя подделать:**
1. У каждого жителя есть копия книги
2. Все страницы связаны ссылками
3. Изменение одной записи требует переписать все последующие страницы
4. И убедить большинство жителей принять поддельную версию

---

## Итоги

Блокчейн — это революционная технология, которая позволяет:
- Создавать доверие без посредников
- Хранить данные безопасно и прозрачно
- Автоматизировать процессы через смарт-контракты
- Строить децентрализованные приложения

В следующих темах мы углубимся в механизмы консенсуса, криптографию и практическую разработку на блокчейне.

---

## Дополнительные ресурсы

- [Bitcoin Whitepaper](https://bitcoin.org/bitcoin.pdf) — оригинальный документ Сатоши Накамото
- [Ethereum Whitepaper](https://ethereum.org/whitepaper/) — основы Ethereum
- [Mastering Bitcoin](https://github.com/bitcoinbook/bitcoinbook) — книга Андреаса Антонопулоса
