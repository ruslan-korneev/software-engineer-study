# Команда rm

## Что такое rm?

**rm** (remove) — команда для удаления файлов и директорий. Это одна из самых опасных команд, так как удаление обычно необратимо.

## Синтаксис

```bash
rm [опции] файл...
```

## Базовое использование

### Удаление файла
```bash
$ rm file.txt
$ rm /path/to/file.txt
```

### Удаление нескольких файлов
```bash
$ rm file1.txt file2.txt file3.txt
$ rm *.log                          # все .log файлы
```

## Основные опции

### -r, -R (recursive) — рекурсивное удаление

Удаляет директории и всё их содержимое:

```bash
$ rm mydir
rm: cannot remove 'mydir': Is a directory

$ rm -r mydir                       # удаляет директорию со всем содержимым
```

### -f (force) — без подтверждений и ошибок

```bash
$ rm -f nonexistent.txt             # не выдаёт ошибку
$ rm -f protected.txt               # не спрашивает подтверждение
```

### -i (interactive) — запрос подтверждения

```bash
$ rm -i *.txt
rm: remove regular file 'file1.txt'? y
rm: remove regular file 'file2.txt'? n
rm: remove regular file 'file3.txt'? y
```

### -I — один запрос для множества файлов

```bash
$ rm -I *.log
rm: remove 15 arguments? y
```

### -v (verbose) — подробный вывод

```bash
$ rm -v file.txt
removed 'file.txt'
```

### -d (directory) — удалить пустую директорию

```bash
$ rm -d empty-dir
# Работает только если директория пуста
```

## Опасные комбинации

### rm -rf — удалить всё рекурсивно без вопросов

```bash
$ rm -rf directory/
```

Это сокращение от `-r` (рекурсивно) и `-f` (без вопросов). Очень мощная и опасная команда.

### НИКОГДА не делайте это:

```bash
# ОПАСНО! Удалит всё в системе!
$ sudo rm -rf /
$ sudo rm -rf /*

# ОПАСНО! Пробел превратит это в удаление всего
$ rm -rf / home/user/trash    # удалит / и home/user/trash
```

## Практические примеры

### Безопасное удаление
```bash
$ rm -i important-file.txt
rm: remove regular file 'important-file.txt'? y
```

### Удаление директории с содержимым
```bash
$ rm -r old-project/
$ rm -rv old-project/           # подробно
```

### Удаление по шаблону
```bash
$ rm *.tmp                      # все .tmp файлы
$ rm -r backup-*/               # все директории backup-*
$ rm file{1,2,3}.txt            # file1.txt, file2.txt, file3.txt
```

### Удаление скрытых файлов
```bash
$ rm .*                         # ОСТОРОЖНО! Может удалить .. (родительскую)
$ rm .??*                       # безопаснее: минимум 3 символа
$ rm .[!.]* ..?*                # ещё безопаснее
```

### Очистка логов (оставить файл, очистить содержимое)
```bash
$ > access.log                  # очистить, но не удалять
$ truncate -s 0 access.log      # альтернатива
```

## Защита от случайного удаления

### Алиас для rm -i
```bash
# В ~/.bashrc
alias rm='rm -i'

$ rm file.txt
rm: remove regular file 'file.txt'? y
```

### Использование trash-cli
```bash
$ sudo apt install trash-cli    # установка

$ trash file.txt                # в корзину
$ trash-list                    # что в корзине
$ trash-restore                 # восстановить
$ trash-empty                   # очистить корзину
```

### Проверка перед удалением
```bash
$ ls *.log                      # сначала посмотрите
$ rm *.log                      # потом удаляйте
```

## Удаление файлов со специальными именами

### Файл начинается с дефиса
```bash
$ rm -file.txt
rm: invalid option -- 'f'

$ rm -- -file.txt               # использовать --
$ rm ./-file.txt                # или указать путь
```

### Файл с пробелами
```bash
$ rm "my file.txt"
$ rm my\ file.txt
```

### Файл со специальными символами
```bash
$ rm 'file?name.txt'
$ rm "file*name.txt"
```

## Альтернативы rm

### rmdir — удаление пустых директорий
```bash
$ rmdir empty-dir               # только если пусто
$ rmdir -p a/b/c                # удалить a/b/c, a/b, a если пусты
```

### unlink — удаление одного файла
```bash
$ unlink file.txt               # удаляет один файл
```

### shred — безопасное удаление (перезапись)
```bash
$ shred -u secret.txt           # перезаписать и удалить
$ shred -n 10 -u secret.txt     # 10 проходов перезаписи
```

## Восстановление после rm

В отличие от корзины в GUI, `rm` удаляет файлы безвозвратно. Восстановление возможно только:

1. **Из резервной копии** (backup)
2. **Специальными утилитами** (extundelete, photorec) — не гарантировано
3. **Не писать на диск** после удаления — повышает шансы

## Советы

1. **Думайте дважды** перед `rm -rf`
2. **Используйте -i** для важных файлов
3. **Проверяйте wildcards** через `ls` перед удалением
4. **Делайте бэкапы** регулярно
5. **Используйте trash-cli** вместо rm для повседневных задач
6. **Никогда не запускайте** `rm -rf /` или похожие команды
