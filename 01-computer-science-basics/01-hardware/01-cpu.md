# CPU (Central Processing Unit)

## Что такое CPU?

**CPU (Central Processing Unit)** — центральный процессор, "мозг" компьютера. Выполняет инструкции программ, производит вычисления и управляет работой всех остальных компонентов.

## Основные компоненты

### ALU (Arithmetic Logic Unit)
Арифметико-логическое устройство — выполняет:
- Арифметические операции: `+`, `-`, `*`, `/`
- Логические операции: `AND`, `OR`, `NOT`, `XOR`
- Сравнения: `>`, `<`, `==`

### Control Unit (CU)
Блок управления:
- Декодирует инструкции
- Управляет потоком данных
- Координирует работу всех частей процессора

### Регистры
Сверхбыстрая память внутри процессора:
- **Регистры общего назначения** — временное хранение данных
- **Счётчик команд (PC)** — адрес следующей инструкции
- **Регистр инструкций (IR)** — текущая выполняемая инструкция
- **Регистр флагов** — состояние после операций (zero, carry, overflow)

### Кэш-память

| Уровень | Размер | Скорость | Назначение |
|---------|--------|----------|------------|
| L1 | 32-64 KB | ~1 нс | Самый быстрый, для каждого ядра |
| L2 | 256 KB - 1 MB | ~3-4 нс | Для каждого ядра |
| L3 | 8-64 MB | ~10-20 нс | Общий для всех ядер |

## Цикл выполнения инструкции

```
┌─────────┐    ┌─────────┐    ┌─────────┐    ┌─────────┐
│  Fetch  │ -> │ Decode  │ -> │ Execute │ -> │  Store  │
└─────────┘    └─────────┘    └─────────┘    └─────────┘
     │              │              │              │
 Загрузить     Декодировать    Выполнить     Сохранить
 инструкцию    инструкцию      операцию      результат
```

## Ключевые характеристики

| Характеристика | Описание | Пример |
|----------------|----------|--------|
| **Тактовая частота** | Скорость выполнения операций | 3.5 GHz = 3.5 млрд тактов/сек |
| **Ядра (Cores)** | Независимые вычислительные блоки | 8 ядер |
| **Потоки (Threads)** | Логические потоки (Hyper-Threading) | 16 потоков |
| **Разрядность** | Размер данных за один такт | 64-bit |
| **TDP** | Тепловыделение | 65W, 125W |
| **Техпроцесс** | Размер транзисторов | 5 nm, 7 nm |

## Архитектуры процессоров

### x86 / x86-64 (AMD64)
- Intel, AMD
- CISC-архитектура (сложные инструкции)
- Десктопы, серверы, ноутбуки

### ARM
- Apple M1/M2/M3, Qualcomm
- RISC-архитектура (простые инструкции)
- Мобильные устройства, Mac, серверы AWS Graviton

### Сравнение CISC vs RISC

| CISC (x86) | RISC (ARM) |
|------------|------------|
| Сложные инструкции | Простые инструкции |
| Меньше инструкций в коде | Больше инструкций в коде |
| Выше энергопотребление | Энергоэффективность |

## Важно для Backend-разработчика

### CPU-bound vs I/O-bound задачи

```
CPU-bound: вычисления, шифрование, сжатие
   → Масштабируем добавлением ядер/потоков

I/O-bound: запросы к БД, сеть, файлы
   → Используем async/await, неблокирующий I/O
```

### Многопоточность
- **Процесс** — изолированная программа со своей памятью
- **Поток** — легковесная единица внутри процесса
- Python GIL ограничивает параллелизм потоков → используем `multiprocessing`

### Оптимизация под кэш
```python
# Плохо: прыжки по памяти
for col in range(1000):
    for row in range(1000):
        matrix[row][col] += 1

# Хорошо: последовательный доступ (cache-friendly)
for row in range(1000):
    for col in range(1000):
        matrix[row][col] += 1
```

### Выбор серверного железа
- **Высокая частота** — для однопоточных задач
- **Много ядер** — для параллельных задач (web-серверы)
- **ARM серверы** — экономия энергии (AWS Graviton)
